colnames(my_right_tail_cdf_matrix) <- c("year", "month", "day", paste("bin",my_positive_bins, sep="_"))
colnames(my_full_dist_cdf_matrix) <- c("year", "month", "day", paste("bin",round(full_dist_bins, 3), sep="_"))
#-------------------------------------------------------------------
# Ambiguity
within_month_left_tail_mean <- as_tibble(my_left_tail_cdf_matrix) %>%
group_by(year, month) %>%
select(everything(),-day) %>%
summarize_all(funs(mean), na.rm = TRUE) %>%
mutate(year_month = paste(year, month, sep="-")) %>%
ungroup() %>%
select(year_month, everything(), -year, -month) %>%
column_to_rownames('year_month')
within_month_left_tail_var <- as_tibble(my_left_tail_cdf_matrix) %>%
group_by(year, month) %>%
select(everything(),-day) %>%
summarize_all(funs(var), na.rm = TRUE) %>%
mutate(year_month = paste(year, month, sep="-")) %>%
ungroup() %>%
select(year_month, everything(), -year, -month) %>%
column_to_rownames('year_month')
within_month_right_tail_mean <- as_tibble(my_right_tail_cdf_matrix) %>%
group_by(year, month) %>%
select(everything(),-day) %>%
summarize_all(funs(mean), na.rm = TRUE) %>%
mutate(year_month = paste(year, month, sep="-")) %>%
ungroup() %>%
select(year_month, everything(), -year, -month) %>%
column_to_rownames('year_month')
within_month_right_tail_var <- as_tibble(my_right_tail_cdf_matrix) %>%
group_by(year, month) %>%
select(everything(),-day) %>%
summarize_all(funs(var), na.rm = TRUE) %>%
mutate(year_month = paste(year, month, sep="-")) %>%
ungroup() %>%
select(year_month, everything(), -year, -month) %>%
column_to_rownames('year_month')
within_month_full_dist_mean <- as_tibble(my_full_dist_cdf_matrix) %>%
group_by(year, month) %>%
select(everything(),-day) %>%
summarize_all(funs(mean), na.rm = TRUE) %>%
mutate(year_month = paste(year, month, sep="-")) %>%
ungroup() %>%
select(year_month, everything(), -year, -month) %>%
column_to_rownames('year_month')
within_month_full_dist_var <- as_tibble(my_full_dist_cdf_matrix) %>%
group_by(year, month) %>%
select(everything(),-day) %>%
summarize_all(funs(var), na.rm = TRUE) %>%
mutate(year_month = paste(year, month, sep="-")) %>%
ungroup() %>%
select(year_month, everything(), -year, -month) %>%
column_to_rownames('year_month')
ambiguity_left_tail <- diag(as.matrix(within_month_left_tail_mean) %*% t(as.matrix(within_month_left_tail_var)) )
ambiguity_left_tail <- as.tibble(ambiguity_left_tail)
ambiguity_right_tail <- diag(as.matrix(within_month_right_tail_mean) %*% t(as.matrix(within_month_right_tail_var)) )
ambiguity_right_tail <- as.tibble(ambiguity_right_tail)
ambiguity_full_dist <- diag(as.matrix(within_month_full_dist_mean) %*% t(as.matrix(within_month_full_dist_var)) )
ambiguity_full_dist <- as.tibble(ambiguity_full_dist)
ambiguity_total <- (ambiguity_left_tail + ambiguity_right_tail)
#-------------------------------------------------------------------
FINAL_my_left_tail_cdf_matrix <- rbind(FINAL_my_left_tail_cdf_matrix, as_tibble(my_left_tail_cdf_matrix))
FINAL_my_right_tail_cdf_matrix <- rbind(FINAL_my_right_tail_cdf_matrix, as_tibble(my_right_tail_cdf_matrix))
FINAL_my_full_dist_cdf_matrix <- rbind(FINAL_my_full_dist_cdf_matrix, as_tibble(my_full_dist_cdf_matrix))
FINAL_left_tail_matrix <- rbind(FINAL_left_tail_matrix, left_tail_matrix)
FINAL_right_tail_matrix <- rbind(FINAL_right_tail_matrix, right_tail_matrix)
FINAL_within_month_left_tail_mean <- rbind(FINAL_within_month_left_tail_mean, within_month_left_tail_mean)
FINAL_within_month_left_tail_var <- rbind(FINAL_within_month_left_tail_var, within_month_left_tail_var)
FINAL_within_month_right_tail_mean <- rbind(FINAL_within_month_right_tail_mean, within_month_right_tail_mean)
FINAL_within_month_right_tail_var <- rbind(FINAL_within_month_right_tail_var, within_month_right_tail_var)
FINAL_within_month_full_dist_mean <- rbind(FINAL_within_month_full_dist_mean, within_month_full_dist_mean)
FINAL_within_month_full_dist_var <- rbind(FINAL_within_month_full_dist_var, within_month_full_dist_var)
FINAL_ambiguity_left_tail <- rbind(FINAL_ambiguity_left_tail, ambiguity_left_tail)
FINAL_ambiguity_right_tail <- rbind(FINAL_ambiguity_right_tail, ambiguity_right_tail)
FINAL_ambiguity_full_dist <- rbind(FINAL_ambiguity_full_dist, ambiguity_full_dist)
FINAL_ambiguity_total <- rbind(FINAL_ambiguity_total, ambiguity_total)
rm(CRSP_codes10_11)
}
#-------------------------------------------------------------------
ambiguity <- tibble(
date = ymd(rownames(FINAL_ambiguity_total), truncated = 1),
portfolio = rep("CRSP_codes10_11", dim(FINAL_ambiguity_total)[1]),
ambiguity_left_tail = FINAL_ambiguity_left_tail$value,
ambiguity_right_tail = FINAL_ambiguity_right_tail$value,
ambiguity_full_dist = FINAL_ambiguity_full_dist$value,
ambiguity_total = FINAL_ambiguity_total$value,
ambiguity_left_tail_scaled = FINAL_ambiguity_left_tail$value*(1/(0.005*(1-0.005))),
ambiguity_right_tail_scaled = FINAL_ambiguity_right_tail$value*(1/(0.005*(1-0.005))),
ambiguity_full_dist_scaled = FINAL_ambiguity_full_dist$value*(1/(0.005*(1-0.005))),
ambiguity_total_scaled = FINAL_ambiguity_total$value*(1/(0.005*(1-0.005)))
)
#-------------------------------------------------------------------
end_time <- Sys.time()
end_time - start_time
#-------------------------------------------------------------------
save.image("C:/Users/Caio Laptop/OneDrive - The University of Kansas/Documents/PhD/13. WPs/08. Ambiguity/02.Codes/06.RData/[2019.03.26]_CRSP_codes10_11_left_right_(thresh_at_0.05_vol_great_100K)_and_full.RData")
load(paste(MyPath,"06.RData\\[2019.03.26]_CRSP_codes10_11_left_right_(thresh_at_0.05_vol_great_100K)_and_full.RData", sep=""))
ambiguity_CRSP_codes10_11 <- ambiguity
rm(list=setdiff(ls(), c("MyPath", "ambiguity_CRSP_codes10_11")))
load(paste(MyPath,"06.RData\\[2019.03.19]_Ambiguity_all_100_and_25_portf.RData", sep=""))
ambiguity_portf_100_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_100_size_btm')
ambiguity_portf_100_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_100_size_inv')
ambiguity_portf_100_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_100_size_Oper_profit')
ambiguity_portf_25_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_25_size_btm')
ambiguity_portf_25_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_25_size_inv')
ambiguity_portf_25_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_25_size_Oper_profit')
rm(list=setdiff(ls(), c("MyPath",
"ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")))
# Plotting Ambuiguities Measures
#-------------------------------------------------------------------
ambiguities_indexes <- c("ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")
ggplot()+
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
plots <- list()
i <- 1
for (ambiguities_indexes_j in ambiguities_indexes){
plots[[i]]<- ggplot()+
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
i = i + 1
}
Ambiguity_indexes_portf_100_plots <- do.call(grid.arrange, c(plots[1:4], nrow=4)) #length(ambiguities_indexes)))
Ambiguity_indexes_portf_100_plots
tomerge<-ambiguity_portf_100_size_btm[,1]
tomerge
test <- lef_join(tomerge, ambiguity_CRSP_codes10_11, by ="date")
test <- left_join(tomerge, ambiguity_CRSP_codes10_11, by ="date")
test
test[is.na(test)] <- 0
test
#-------------------------------------------------------------------
MyPath <- "C:\\Users\\Caio Laptop\\OneDrive - The University of Kansas\\Documents\\PhD\\13. WPs\\08. Ambiguity\\02.Codes\\"
setwd(MyPath)
library(data.table)
library(tidyr)
library(tibble)
library(dplyr)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(stringr)
library(sandwich) # for HAC cov matrix
library(lmtest)
#-------------------------------------------------------------------
load(paste(MyPath,"06.RData\\[2019.03.26]_CRSP_codes10_11_left_right_(thresh_at_0.05_vol_great_100K)_and_full.RData", sep=""))
ambiguity_CRSP_codes10_11 <- ambiguity
rm(list=setdiff(ls(), c("MyPath", "ambiguity_CRSP_codes10_11")))
load(paste(MyPath,"06.RData\\[2019.03.19]_Ambiguity_all_100_and_25_portf.RData", sep=""))
ambiguity_portf_100_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_100_size_btm')
ambiguity_portf_100_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_100_size_inv')
ambiguity_portf_100_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_100_size_Oper_profit')
ambiguity_portf_25_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_25_size_btm')
ambiguity_portf_25_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_25_size_inv')
ambiguity_portf_25_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_25_size_Oper_profit')
rm(list=setdiff(ls(), c("MyPath",
"ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")))
#-------------------------------------------------------------------
ambiguity_CRSP_codes10_11 <- left_join(ambiguity_portf_100_size_btm[,1], ambiguity_CRSP_codes10_11, by ="date")
ambiguity_CRSP_codes10_11[is.na(ambiguity_CRSP_codes10_11)] <- 0
# Plotting Ambuiguities Measures
#-------------------------------------------------------------------
ambiguities_indexes <- c("ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")
plots <- list()
i <- 1
for (ambiguities_indexes_j in ambiguities_indexes){
plots[[i]]<- ggplot()+
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
i = i + 1
}
Ambiguity_indexes_portf_100_plots <- do.call(grid.arrange, c(plots[1:4], nrow=4)) #length(ambiguities_indexes)))
Ambiguity_indexes_portf_100_plots
plots <- list()
i <- 1
for (ambiguities_indexes_j in ambiguities_indexes){
plots[[i]]<- ggplot()+
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
i = i + 1
}
Ambiguity_indexes_portf_100_plots <- do.call(grid.arrange, c(plots[1:4], nrow=4)) #length(ambiguities_indexes)))
Ambiguity_indexes_portf_100_plots
#-------------------------------------------------------------------
MyPath <- "C:\\Users\\Caio Laptop\\OneDrive - The University of Kansas\\Documents\\PhD\\13. WPs\\08. Ambiguity\\02.Codes\\"
setwd(MyPath)
library(data.table)
library(tidyr)
library(tibble)
library(dplyr)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(stringr)
library(sandwich) # for HAC cov matrix
library(lmtest)
#-------------------------------------------------------------------
load(paste(MyPath,"06.RData\\[2019.03.26]_CRSP_codes10_11_left_right_(thresh_at_15th-percentile)_and_full.RData", sep=""))
ambiguity_CRSP_codes10_11 <- ambiguity
rm(list=setdiff(ls(), c("MyPath", "ambiguity_CRSP_codes10_11")))
load(paste(MyPath,"06.RData\\[2019.03.19]_Ambiguity_all_100_and_25_portf.RData", sep=""))
ambiguity_portf_100_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_100_size_btm')
ambiguity_portf_100_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_100_size_inv')
ambiguity_portf_100_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_100_size_Oper_profit')
ambiguity_portf_25_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_25_size_btm')
ambiguity_portf_25_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_25_size_inv')
ambiguity_portf_25_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_25_size_Oper_profit')
rm(list=setdiff(ls(), c("MyPath",
"ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")))
#-------------------------------------------------------------------
ambiguity_CRSP_codes10_11 <- left_join(ambiguity_portf_100_size_btm[,1], ambiguity_CRSP_codes10_11, by ="date")
ambiguity_CRSP_codes10_11[is.na(ambiguity_CRSP_codes10_11)] <- 0
# Plotting Ambuiguities Measures
#-------------------------------------------------------------------
ambiguities_indexes <- c("ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")
plots <- list()
i <- 1
for (ambiguities_indexes_j in ambiguities_indexes){
plots[[i]]<- ggplot()+
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
i = i + 1
}
Ambiguity_indexes_portf_100_plots <- do.call(grid.arrange, c(plots[1:4], nrow=4)) #length(ambiguities_indexes)))
Ambiguity_indexes_portf_100_plots
#-------------------------------------------------------------------
MyPath <- "C:\\Users\\Caio Laptop\\OneDrive - The University of Kansas\\Documents\\PhD\\13. WPs\\08. Ambiguity\\02.Codes\\"
setwd(MyPath)
library(data.table)
library(tidyr)
library(tibble)
library(dplyr)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(stringr)
library(sandwich) # for HAC cov matrix
library(lmtest)
#-------------------------------------------------------------------
load(paste(MyPath,"06.RData\\[2019.03.26]_CRSP_codes10_11_left_right_(thresh_at_15th-percentile)_and_full.RData", sep=""))
ambiguity_CRSP_codes10_11 <- ambiguity
rm(list=setdiff(ls(), c("MyPath", "ambiguity_CRSP_codes10_11")))
load(paste(MyPath,"06.RData\\[2019.03.19]_Ambiguity_all_100_and_25_portf.RData", sep=""))
ambiguity_portf_100_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_100_size_btm')
ambiguity_portf_100_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_100_size_inv')
ambiguity_portf_100_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_100_size_Oper_profit')
ambiguity_portf_25_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_25_size_btm')
ambiguity_portf_25_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_25_size_inv')
ambiguity_portf_25_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_25_size_Oper_profit')
rm(list=setdiff(ls(), c("MyPath",
"ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")))
#-------------------------------------------------------------------
ambiguity_CRSP_codes10_11 <- left_join(ambiguity_portf_100_size_btm[,1], ambiguity_CRSP_codes10_11, by ="date")
ambiguity_CRSP_codes10_11[is.na(ambiguity_CRSP_codes10_11)] <- 0
# Plotting Ambuiguities Measures
#-------------------------------------------------------------------
ambiguities_indexes <- c("ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")
plots <- list()
i <- 1
for (ambiguities_indexes_j in ambiguities_indexes){
plots[[i]]<- ggplot()+
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
i = i + 1
}
Ambiguity_indexes_portf_100_plots <- do.call(grid.arrange, c(plots[1:4], nrow=4)) #length(ambiguities_indexes)))
Ambiguity_indexes_portf_100_plots
#-------------------------------------------------------------------
MyPath <- "C:\\Users\\Caio Laptop\\OneDrive - The University of Kansas\\Documents\\PhD\\13. WPs\\08. Ambiguity\\02.Codes\\"
setwd(MyPath)
library(data.table)
library(tidyr)
library(tibble)
library(dplyr)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(stringr)
library(sandwich) # for HAC cov matrix
library(lmtest)
#-------------------------------------------------------------------
load(paste(MyPath,"06.RData\\[2019.03.21]_CRSP_codes10_11_left_right_(thresh_at_0)_and_full.RData", sep=""))
ambiguity_CRSP_codes10_11 <- ambiguity
rm(list=setdiff(ls(), c("MyPath", "ambiguity_CRSP_codes10_11")))
#-------------------------------------------------------------------
MyPath <- "C:\\Users\\Caio Laptop\\OneDrive - The University of Kansas\\Documents\\PhD\\13. WPs\\08. Ambiguity\\02.Codes\\"
setwd(MyPath)
library(data.table)
library(tidyr)
library(tibble)
library(dplyr)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(stringr)
library(sandwich) # for HAC cov matrix
library(lmtest)
#-------------------------------------------------------------------
load(paste(MyPath,"06.RData\\[2019.03.21]_CRSP_codes10_11_left_right_(thresh_at_0)_and_full.RData", sep=""))
ambiguity_CRSP_codes10_11 <- ambiguity
rm(list=setdiff(ls(), c("MyPath", "ambiguity_CRSP_codes10_11")))
load(paste(MyPath,"06.RData\\[2019.03.19]_Ambiguity_all_100_and_25_portf.RData", sep=""))
ambiguity_portf_100_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_100_size_btm')
ambiguity_portf_100_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_100_size_inv')
ambiguity_portf_100_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_100_size_Oper_profit')
ambiguity_portf_25_size_btm <- filter(FINAL_ambiguity, portfolio=='portf_25_size_btm')
ambiguity_portf_25_size_inv <- filter(FINAL_ambiguity, portfolio=='portf_25_size_inv')
ambiguity_portf_25_size_Oper_profit <- filter(FINAL_ambiguity, portfolio=='portf_25_size_Oper_profit')
rm(list=setdiff(ls(), c("MyPath",
"ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")))
#-------------------------------------------------------------------
ambiguity_CRSP_codes10_11 <- left_join(ambiguity_portf_100_size_btm[,1], ambiguity_CRSP_codes10_11, by ="date")
ambiguity_CRSP_codes10_11[is.na(ambiguity_CRSP_codes10_11)] <- 0
# Plotting Ambuiguities Measures
#-------------------------------------------------------------------
ambiguities_indexes <- c("ambiguity_CRSP_codes10_11",
"ambiguity_portf_100_size_btm",
"ambiguity_portf_100_size_inv",
"ambiguity_portf_100_size_Oper_profit",
"ambiguity_portf_25_size_btm",
"ambiguity_portf_25_size_inv",
"ambiguity_portf_25_size_Oper_profit")
plots <- list()
i <- 1
for (ambiguities_indexes_j in ambiguities_indexes){
plots[[i]]<- ggplot()+
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_total_scaled)), color='black', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_left_tail_scaled)), color='red', size=1) +
# geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_full_dist_scaled)), color='blue', size=1) +
geom_line(aes_string(x= as_date(get(ambiguities_indexes_j)$date), y=sqrt(get(ambiguities_indexes_j)$ambiguity_right_tail_scaled)), color='purple', size=1) +
scale_x_date(breaks="3 years", minor_breaks = "1 year", date_labels="%y-%m") +
geom_vline(xintercept = ymd("1987-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1994-10-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("1998-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2001-02-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2008-09-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-04-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2010-12-01"), linetype = "dashed") +
geom_vline(xintercept = ymd("2016-11-01"), linetype = "dashed") +
labs(title=ambiguities_indexes_j)
i = i + 1
}
Ambiguity_indexes_portf_100_plots <- do.call(grid.arrange, c(plots[1:4], nrow=4)) #length(ambiguities_indexes)))
Ambiguity_indexes_portf_100_plots
getwd()
#--WAGE1-----------------------------------------------------------------------------------------------
load("C:/Users/Caio Laptop/OneDrive - The University of Kansas/Documents/PhD/10. GTA/2018.02/01.Textbook/Data Sets/Data Sets - R/wage1.RData")
wage1<-data
rm(data)
library("psych")
describe(wage1)
library(stargazer) #to report regression results in Latex format
stargazer(wage1, type='text', digits=2)
regression_wage1 <- lm(wage ~ educ, data = wage1)
summary(regression_wage1)
stargazer(regression_wage1, align=TRUE, digits=2)
stargazer(regression_wage1, type='text', digits=2)
names(regression_wage1)
View(regression_wage1$residuals)
plot(regression_wage1$residuals)
plot(regression_wages)
plot(regression_wages1)
plot(regression_wage1)
regression_wage1 <- lm(wage ~ educ, data = wage1)
regression_wage2 <- lm(wage ~ educ + exper, data = wage1)
stargazer(regression_wage1, regression_wage2, type='text', digits=2)
names(regression_wage1)
View(regression_wage1$residuals)
plot(regression_wage1$residuals)
abline(h=0, col='grey')
plot(wage1$educ, wage1$wage, yaxs = "i", ylim=c(min(wage1$wage)-3, max(wage1$wage)+3),pch=16)
lines(wage1$educ,fitted(regression_wage1), type='l', col='red')
abline(h=0,v=0,col='grey')
library(stargazer)
#--WAGE1-----------------------------------------------------------------------------------------------
load("C:/Users/Caio Laptop/OneDrive - The University of Kansas/Documents/PhD/10. GTA/2018.02/01.Textbook/Data Sets/Data Sets - R/wage1.RData")
stargazer(data, type='text')
lm(wage~educ, data=data)
reg1<-lm(wage~educ, data=data)
reg2<-lm(wage~educ+exper+tenure, data=data)
reg1
reg2
summary(re1)
summary(reg1)
stargazer(reg1, type='text')
stargazer(reg2, type='text')
8*12.5
